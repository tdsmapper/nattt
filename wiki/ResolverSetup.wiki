#summary Setting up the DNS Resolver to work with NAT3D

= Introduction =

Following are the instructions to set up the BIND9 DNS Resolver to work with NAT3D. BIND9 can be [http://www.bind9.net/download downloaded] and installed for Linux/UNIX/Mac and Windows.

= Details =

== Custom DNS record ==
NAT3D uses a custom record number 65324 to store data about tunneling through the NAT box. If this conflicts with something that you use, please change this in _dns_rr.h_:

{{{ #define DNS_RR_NAT3 65324 }}}

It is recommended to change the number to a number between 65280-65535 (Private use numbers). The corresponding DNS RR Type in BIND9 will be TYPE6xxxx. In the example above, it would be TYPE65324..

== Generating the NAT3 Resource Record ==
In order to generate a usable NAT3 resource record in a format that NAT3D can understand, use the _scripts/gen_nat3.pl_ script. The format for the script is:

{{{ /gen nat3.pl <name> <external> <port> <internal> }}}

Where _name_ refers to the FQDN (ending with a period) name for the server, _external_ refers to the NAT box's address, _port_ refers to the port NAT3D listens on (set up in [ConfigFile config file]), _internal_ refers to the IP address on which NAT3D listens (set up in [ConfigFile config file]).

This record is copy into the zone database of BIND9 (eg. myzone.db)

Alternatively, you can use BIND's[BINDDynDNS dynamic dns] to do achieve the same.

== Setting up the DNS Zone ==
You need to set up a zone that is authoritative for names that return a NAT3 record type. Good information is found [http://www.debuntu.org/book/export/html/85 here].

For a sample DNS Zone file used, please [SampleZoneFile view]. This applies to BIND9 on Linux/Windows. On Windows, just the paths need to be changed to point to the BIND9 installation.

== Testing the DNS Resolver ==
You can use the _dig_ command to test the resolver. _dig_ is available on Mac and Linux, and is found in the bind directory for Windows installs.

The test command is:

{{{ dig @<DNS Server> <Name of server behind NATTT> <DNS Type> }}}

Where:
  * Name of server: Name of the NAT3 Record holding the server information generated by the _gen_nat3.pl_.
  * DNS Type: Type of record you want to query for. If the DNS Custom record number you used is 65324, the DNS Type is _TYPE65324_

If you query for an "A" record for the server name, you would get back either a NXDOMAIN (Non-existant domain), or a response with no answer section. Querying for the custom type should return the data you generated via the _gen_nat3.pl_ script.

Back to [Introduction introduction].